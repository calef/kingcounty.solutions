---
layout: default
title: Organizations Directory
---

<article>
  <header>
    {% include breadcrumbs.html %}
    <h1>{{ page.title }}</h1>
  </header>
  {{ content }}

  {% assign organizations = site.organizations | sort: "title" %}

  <div class="organizations-table-wrapper">
    <table id="organization-directory" class="sortable-table">
      <thead>
        <tr>
          <th class="sortable" data-type="string">
            Title
            <span class="sort-indicator" aria-hidden="true"></span>
          </th>
          <th class="sortable" data-type="string">
            Type
            <span class="sort-indicator" aria-hidden="true"></span>
          </th>
          <th class="sortable" data-type="number">
            Post Count
            <span class="sort-indicator" aria-hidden="true"></span>
          </th>
        </tr>
      </thead>
      <tbody>
        {% for organization in organizations %}
          {% assign post_count = site.posts | where: "source", organization.title | size %}
          <tr>
            <td><a href="{{ organization.url | relative_url }}">{{ organization.title }}</a></td>
            <td>{{ organization.type }}</td>
            <td>{{ post_count }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</article>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const table = document.getElementById('organization-directory');
    if (!table) return;

    const getCellValue = (row, index, type) => {
      const value = row.children[index].innerText.trim();
      return type === 'number' ? parseInt(value, 10) || 0 : value.toLowerCase();
    };

    const compare = (a, b, type, asc) => {
      const valueA = type === 'number' ? a - b : a.localeCompare(b);
      return asc ? valueA : -valueA;
    };

    table.querySelectorAll('th.sortable').forEach((th, index) => {
      let asc = true;
      th.addEventListener('click', () => {
        const type = th.dataset.type || 'string';
        const rows = Array.from(table.tBodies[0].rows);
        rows.sort((rowA, rowB) => {
          const valA = getCellValue(rowA, index, type);
          const valB = getCellValue(rowB, index, type);
          return compare(valA, valB, type, asc);
        });
        rows.forEach(row => table.tBodies[0].appendChild(row));
        table.querySelectorAll('th.sortable').forEach(header => {
          header.classList.remove('sorted-asc', 'sorted-desc');
        });
        th.classList.add(asc ? 'sorted-asc' : 'sorted-desc');
        asc = !asc;
      });
    });
  });
</script>
